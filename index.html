<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dynamic HTML Loader with Discord Image Generation</title>
  <script>
    // Function to parse the URL parameters using only '?'
    function getParams() {
      const query = window.location.search.slice(1); // Remove the leading '?'
      const params = {};
      const pairs = query.split('?');
      pairs.forEach(pair => {
        const [key, value] = pair.split('=');
        if (key && value) {
          params[key] = decodeURIComponent(value);
        }
      });
      return params;
    }

    // Function to generate an image based on the URL parameters
    function generateImage() {
      const params = getParams();
      const color = params.color || 'defaultColor'; // Default to 'defaultColor' if no color is provided
      const button = params.button || 'defaultButton'; // Default to 'defaultButton' if no button is provided

      // Check if the image exists in the directory
      const imageName = `${color}-${button}.png`;
      const imagePath = `./${imageName}`;

      const image = new Image();
      image.src = imagePath;
      image.onerror = function() {
        // If the image doesn't exist, show the fallback 404 image
        image.src = './404.png';
      };
      document.body.appendChild(image); // Append the image to the body
    }

    document.addEventListener("DOMContentLoaded", () => {
      const params = getParams();

      // If the 'html' parameter is present, load the HTML file
      if (params.html) {
        const htmlFile = params.html;
        const htmlPath = `./${htmlFile}.html`;
        console.log(`Loading HTML content from: ${htmlPath}`);

        const iframe = document.createElement("iframe");
        iframe.src = htmlPath;
        iframe.style.width = "100%";
        iframe.style.height = "100vh";
        iframe.style.border = "none";
        iframe.style.position = "absolute";
        iframe.style.top = "0";
        iframe.style.left = "0";
        document.body.appendChild(iframe);
      }

      // Generate the image if 'color' and 'button' parameters are present
      generateImage();
    });
  </script>
</head>
<body style="margin: 0; overflow: hidden;">
  <h1>Dynamic Content and Image Loader</h1>
</body>
</html>
